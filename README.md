# SKN07-2nd-4Team 

> **íŒ€ì› : ê¹€ì„±ê·¼, ëŒ€ì„±ì›, ìœ ìˆ˜í˜„, ìœ¤ì •ì—°, ì •ìŠ¹ì—°**
</br>

<div align="center">
  <h2><strong> ğŸ“ í†µì‹ ì‚¬ ì´ìš© ê³ ê° ì´íƒˆ ì˜ˆì¸¡ ğŸ“ </h2></strog>
  2024.12.16 ~ 2024.12.17 
</div>
<br><br>
<div align="center">
    <div>
        <img src="https://img.shields.io/badge/Visual%20Studio%20Code-007ACC?style=flat&logo=Visual%20Studio%20Code&logoColor=white"/>
        <img src="https://img.shields.io/badge/Python-3776AB?style=flat&logo=Python&logoColor=white"/>
        <img src="https://img.shields.io/badge/Machine%20Learning-FF6F00?style=flat&logo=Artificial%20Intelligence&logoColor=white"/>
        <img src="https://img.shields.io/badge/scikit--learn-F7931E?style=flat&logo=scikit-learn&logoColor=white"/>
        <br/>
        <img src="https://img.shields.io/badge/Git-F05032?style=flat&logo=Git&logoColor=white"/>
        <img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/>
        <img src="https://img.shields.io/badge/Discord-5865F2?style=flat&logo=Discord&logoColor=white"/>
    </div>
</div>
<br><br>
    
---
<br>

### 1. í”„ë¡œì íŠ¸ ê°œìš” 
ì´ í”„ë¡œì íŠ¸ëŠ” í†µì‹ ì‚¬ì˜ ê³ ê° ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ê³ ê°ì˜ ì´íƒˆ(Churn)ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ ê°œë°œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
ê³ ê° ì´íƒˆ ì˜ˆì¸¡ì€ ë¹„ì¦ˆë‹ˆìŠ¤ì˜ í•µì‹¬ ë¬¸ì œ ì¤‘ í•˜ë‚˜ë¡œ, ê³ ê°ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ìˆ˜ìµì„±ì— í° ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.
ê³ ê°ì´ ì´íƒˆí•  ê°€ëŠ¥ì„±ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ êµ¬ì¶•í•˜ì—¬, í†µì‹ ì‚¬ëŠ” ì´íƒˆ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì„ ì‚¬ì „ì— ì‹ë³„í•˜ê³ , ê·¸ì— ë§ëŠ” ë§ˆì¼€íŒ… ì „ëµì„ í†µí•´ ê³ ê°ì„ ìœ ì§€í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

</br>

### 2. í”„ë¡œì íŠ¸ ë°°ê²½ 
- ê³ ê° ì´íƒˆ ë¬¸ì œ
í†µì‹ ì‚¬ì™€ ê°™ì€ ì„œë¹„ìŠ¤ ê¸°ë°˜ ê¸°ì—…ì—ê²Œ ê³ ê° ì´íƒˆì€ ì¤‘ìš”í•œ ê²½ì˜ ë¬¸ì œì…ë‹ˆë‹¤. </br>
ê³ ê°ì´ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ë‹¨í•˜ê±°ë‚˜ ê²½ìŸì‚¬ì˜ ì„œë¹„ìŠ¤ë¡œ ì´ë™í•˜ë©´, ê¸°ì—…ì€ ìˆ˜ìµ ê°ì†ŒëŠ” ë¬¼ë¡ , ìƒˆë¡œìš´ ê³ ê°ì„ ìœ ì¹˜í•˜ê¸° ìœ„í•œ ë§ˆì¼€íŒ… ë¹„ìš©ì´ ê¸‰ì¦í•˜ê²Œ ë©ë‹ˆë‹¤. </br>
ê³ ê° ì´íƒˆì„ ì˜ˆì¸¡í•˜ëŠ” ëŠ¥ë ¥ì„ ê°•í™”í•˜ë©´, ê¸°ì—…ì€ ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ ê³ ê°ì„ ìœ ì§€í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ê³ ê° ì¶©ì„±ë„ë¥¼ ë†’ì´ê³  ìˆ˜ìµì„±ì„ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ê³ ê° ì´íƒˆ ë°ì´í„° ë¶„ì„ì˜ í•„ìš”ì„±
ê³¼ê±°ì˜ ê³ ê° ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ê³ ê°ì˜ ì´íƒˆ íŒ¨í„´ì„ íŒŒì•…í•˜ëŠ” ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤.</br>
ê³ ê°ì˜ ë‚˜ì´, ì‚¬ìš© ê¸°ê°„, ì„œë¹„ìŠ¤ ì´ìš© íŒ¨í„´, ìš”ê¸ˆì œ ë“± ë‹¤ì–‘í•œ íŠ¹ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ì´íƒˆ ì˜ˆì¸¡ ëª¨ë¸ì„ ê°œë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</br>
ë°ì´í„° ë¶„ì„ì„ í†µí•´ ê³ ê°ì˜ í–‰ë™ì„ ì´í•´í•˜ê³ , ì´íƒˆì„ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ì „ëµì„ ì„¸ìš¸ ìˆ˜ ìˆìœ¼ë©°, ë§ì¶¤í˜• ê³ ê° ê´€ë¦¬ê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.
</br>

### 3. í”„ë¡œì íŠ¸ ëª©í‘œ 

ê³ ê° ì´íƒˆ ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ</br>
- ê³ ê°ì˜ ì´íƒˆ ê°€ëŠ¥ì„±ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ê°œë°œí•©ë‹ˆë‹¤.

í™œìš© ëª©í‘œ
- ëª¨ë¸ì„ í†µí•´ ì´íƒˆ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì„ ì‹ë³„í•œ í›„, ê³ ê° ì„¸ë¶„í™”ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ë§ì¶¤í˜• ëŒ€ì‘ ë° ë§ì¶¤í˜• ë§ˆì¼€íŒ… ì „ëµì„ ì œì‹œí•©ë‹ˆë‹¤.</br>
  ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì—°ë ¹ëŒ€ë‚˜ íŠ¹ì • ìš”ê¸ˆì œì—ì„œ ì´íƒˆì´ ë§ë‹¤ë©´ í•´ë‹¹ ê·¸ë£¹ì— ëŒ€í•œ íŠ¹ë³„í•œ í˜œíƒì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆì¸¡ ëª¨ë¸ì„ í†µí•´ ê³ ê° ì´íƒˆì„ ì¤„ì´ê³ , ê³ ê° ìœ ì§€ìœ¨ì„ í–¥ìƒì‹œí‚¤ëŠ” ì „ëµì„ ì œì‹œí•©ë‹ˆë‹¤.


</br>

### 4. í”„ë¡œì íŠ¸ ê³¼ì •
 (1) Dataset ì¤€ë¹„
 > Telecom Churn : 13.37MB
 <br>dtypes: float64(26), int64(9), object(23)
 <br>RangeIndex: 51047 entries, 0 to 51046
 <br>Data columns : total 58 columns
 <br>Target : Yes(1) : No(0) = 1 : 4
 <br>ì¶œì²˜ : Kaggle (https://www.kaggle.com/datasets/jpacse/datasets-for-churn-telecom/data?select=cell2celltrain.csv)

<br><br>

 (2) EDA
 >58ê°œì˜ Columnì„ 6ê°œì˜ DataFrameìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ Heatmap ì‹œê°í™”
 <br>
 <img width="400px" src="image/billing_usage_heatmap.png" />
 <img width="400px" src="image/call_stats_heatmap.png" /> 
 <img width="400px" src="image/customer_churn_heatmap.png" /> 
 <img width="450px" src="image/customer_lifestyle_heatmap.png" /> 
 <img width="400px" src="image/customer_profile_heatmap.png" /> 
 <img width="400px" src="image/handset_details_heatmap.png" /> 
 <br>
 
<br><br>

 >Feature ì¤‘ìš”ë„ ìˆœìœ„ì— ë”°ë¼ ìƒìœ„ 40ê°œ í•­ëª©ì„ ì¶”ì¶œí•˜ì—¬ í›ˆë ¨ ë°ì´í„°ë¡œ ì‚¬ìš©
 <img width="900px" height="700" src="image/feature_importance.png" />

<br><br>

 >ìƒìœ„ 40ê°œ í•­ëª© Column ì •ë³´ í™•ì¸
 <img width="500px" height="1000" src="image/columns.png" />

<br><br>

 (3) ë°ì´í„° ì „ì²˜ë¦¬ 
 
<br><br><br>â–¶ ê²°ì¸¡ì¹˜ ì œê±° 
``` python
df_all = train_file.dropna().copy()
df_all.isnull().sum()
```

<img width="300" alt="image" src="https://github.com/user-attachments/assets/1517f21a-2fb1-407d-92e8-a906499c8d39" /> <img width="300" alt="image" src="https://github.com/user-attachments/assets/487f1ed0-9284-48ba-9739-59bf24bbd03f" />

<br>â–¶ ë¼ë²¨ê°’(Churn) object -> int ë³€ê²½ 
``` python
churn_label = {'No': 0.0, 'Yes': 1.0} # ìœ ì§€ 0, ì´íƒˆ 1
df_all['Churn'] = df_all['Churn'].map(churn_label)
df_all
```

<br>â–¶ ë¼ë²¨ê°’(Churn) ë¹„ìœ¨ í™•ì¸
``` python
import numpy as np
np.unique(df_all['Churn'], return_counts=True)
```
<img width="800" alt="image" src="https://github.com/user-attachments/assets/e7e47fef-2fb2-47bc-aefc-48eaae314849" />

<br>
 (4) ëª¨ë¸ë§ 

 â–¶ ëª¨ë¸ í›ˆë ¨ì— ì‚¬ìš©í•  ì»¬ëŸ¼ë§Œ ì„ íƒí•˜ì—¬ X,y ë°ì´í„° ìƒì„± ë° ì¸ì½”ë”©
 ``` python
 # ìƒê´€ ê³„ìˆ˜ê°€ ë†’ì€ ì»¬ëŸ¼ì„ ì„ íƒ
 X_data = df_all[['CustomerID','MonthlyRevenue','MonthlyMinutes','TotalRecurringCharge','OverageMinutes','RoamingCalls','PercChangeMinutes','PercChangeRevenues','MonthsInService','RetentionCalls','RetentionOffersAccepted','NewCellphoneUser','NotNewCellphoneUser','ReferralsMadeBySubscriber','AdjustmentsToCreditRating','MadeCallToRetentionTeam','CreditRating','PeakCallsInOut','OffPeakCallsInOut','ReceivedCalls','UnansweredCalls','OutboundCalls','DroppedBlockedCalls','DroppedCalls','InboundCalls','BlockedCalls','DirectorAssistedCalls','CustomerCareCalls','CallWaitingCalls','CurrentEquipmentDays','HandsetRefurbished','IncomeGroup','PrizmCode','Occupation','MaritalStatus','HandsetModels','AgeHH1','ChildrenInHH','HandsetPrice','ThreewayCalls','Handsets']].copy()

# ì´íƒˆìœ¨
y_data = df_all['Churn']

# object íƒ€ì… ì»¬ëŸ¼ í™•ì¸ 
X_data[X_data.select_dtypes(include=['object']).columns]

# object íƒ€ì… unique ê°’ í™•ì¸ 
print(f'NewCellphoneUser : {X_data.NewCellphoneUser.unique(),} \n\
NotNewCellphoneUser : {X_data.NotNewCellphoneUser.unique(),}  \n\
MadeCallToRetentionTeam : {X_data.MadeCallToRetentionTeam.unique(),} \n\
CreditRating : {X_data.CreditRating.unique(),} \n\
HandsetRefurbished : {X_data.HandsetRefurbished.unique(),} \n\
PrizmCode : {X_data.PrizmCode.unique(),} \n\
Occupation : {X_data.Occupation.unique(),}  \n\
MaritalStatus : {X_data.MaritalStatus.unique(),}  \n\
ChildrenInHH : {X_data.ChildrenInHH.unique(),} \n\
HandsetPrice : {X_data.HandsetPrice.unique()} ')
 ```
<img width="800" alt="image" src="https://github.com/user-attachments/assets/f785e583-26cd-41e8-8eb4-b52332f77377" />

<br><br>

 (4) ëª¨ë¸ë§ \
 â–¶ ë°ì´í„°ì…‹ ë¶„ë¦¬
 1. ì…ë ¥ ë°ì´í„°ì™€ íƒ€ê²Ÿ ë°ì´í„°ë¡œ ë¶„ë¦¬
 2. í›ˆë ¨ ë°ì´í„°ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ìœ¼ë¡œ ë¶„ë¦¬
 3. í›ˆë ¨ ë°ì´í„°ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì˜ íƒ€ê²Ÿ ë¶„í¬ê°€ ì ì ˆí•œì§€ í™•ì¸

-------------------------------------

## Machine Learning
### 1. gradient_boosting_classifier 
``` python
 params = {
        "n_estimators": [10, 50, 100, 200, 300],  # ëª¨ë¸ ìƒì„± íŠ¸ë¦¬ ê°œìˆ˜
        "learning_rate": [0.1],                   # í•™ìŠµë¥ 
        "max_depth": [1, 2, 3, 4, 5],             # íŠ¸ë¦¬ ìµœëŒ€ ê¹Šì´
        "subsample": [0.5, 0.7],                  # sample rate
}

model = GradientBoostingClassifier()
model.fit(X_train_scaler, y_train)

#GridSearchCV ì‚¬ìš© (êµì°¨ ê²€ì¦ì„ í†µí•œ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”)
grid_search = GridSearchCV(
    estimator=model,          
    param_grid=params,  
    scoring='accuracy',
    refit='accuracy',
    cv=5,             
    n_jobs=-1,         
)

grid_search.fit(X_train_scaler, y_train)

best_param_ = grid_search.best_params_
best_model = grid_search.best_estimator_ 
```

# ìµœì ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì¶œë ¥
print("Best Parameters:", best_param_)
print("Best models:", best_model)

y_preds = best_model.predict(X_test_scaler)
y_probs = best_model.predict_proba(X_test_scaler)[:, 1] if hasattr(best_model, "predict_proba") else None

2. logistic_regression
3. random_forest_classifier
4. xgb_classifier

</br>

### 5. í”„ë¡œì íŠ¸ ê²°ê³¼

</br>

**1) ëª¨ë¸ ì„±ëŠ¥ í‰ê°€**
ê° ëª¨ë¸ì˜ ì„±ëŠ¥ì€ êµì°¨ ê²€ì¦ì„ í†µí•´ ê²€í† ë˜ì—ˆìœ¼ë©°, ì£¼ìš” í‰ê°€ì§€í‘œì¸ **ì •í™•ë„(Accuracy)**, **ì •ë°€ë„(Precision)**, **ì¬í˜„ìœ¨(Recall)**, **F1 ì ìˆ˜** ë° **ROC-AUC**ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

</br>

**2) ëª¨ë¸ë§**
ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression), ê²°ì • íŠ¸ë¦¬(Decision Tree), ëœë¤ í¬ë ˆìŠ¤íŠ¸(Random Forest), ê·¸ë˜ë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…(Gradient Boosting), XGBoost ë“± ë‹¤ì–‘í•œ ëª¨ë¸ì´ ì‹¤í—˜ë˜ì—ˆìŠµë‹ˆë‹¤.
- **ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression)**
  - ëª¨ë¸ ê²°ê³¼: [ëª¨ë¸ ê²°ê³¼ ì‚½ì…]
  
- **ê²°ì • íŠ¸ë¦¬(Decision Tree)**
  - ëª¨ë¸ ê²°ê³¼: [ëª¨ë¸ ê²°ê³¼ ì‚½ì…]
  
- **ëœë¤ í¬ë ˆìŠ¤íŠ¸(Random Forest)**
  - ëª¨ë¸ ê²°ê³¼: [ëª¨ë¸ ê²°ê³¼ ì‚½ì…]
  
- **ê·¸ë˜ë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…(Gradient Boosting)**
  - ëª¨ë¸ ê²°ê³¼: [ëª¨ë¸ ê²°ê³¼ ì‚½ì…]
  
- **XGBoost**
  - ëª¨ë¸ ê²°ê³¼: [ëª¨ë¸ ê²°ê³¼ ì‚½ì…]


ê° ëª¨ë¸ì˜ ê²°ê³¼ëŠ” ê³ ê° ì´íƒˆì„ ì˜ˆì¸¡í•˜ëŠ” ë° ìˆì–´ **ìƒë‹¹íˆ ë†’ì€ ì •í™•ë„**ë¥¼ ê¸°ë¡í–ˆìœ¼ë©°, íŠ¹íˆ **ëœë¤ í¬ë ˆìŠ¤íŠ¸**ì™€ **XGBoost** ëª¨ë¸ì€ **ROC-AUC** ì ìˆ˜ê°€ ë†’ê²Œ ë‚˜ì™€, ëª¨ë¸ì˜ **ë¶„ë¥˜ ì„±ëŠ¥**ì´ ìš°ìˆ˜í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

</br>
</br>

**3) ëª¨ë¸ ì„ íƒ ë° ê²°ê³¼ ë¶„ì„**

</br>

ê° ëª¨ë¸ì˜ ì„±ëŠ¥ì€ êµì°¨ ê²€ì¦ì„ í†µí•´ ê²€í† ë˜ì—ˆìœ¼ë©°, ì£¼ìš” í‰ê°€ì§€í‘œì¸ **ì •í™•ë„(Accuracy)**, **ì •ë°€ë„(Precision)**, **ì¬í˜„ìœ¨(Recall)**, **F1 ì ìˆ˜** ë° **ROC-AUC**ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

(ê²°ê³¼ ìº¡ì³ ì‚¬ì§„)

- **ì •í™•ë„(Accuracy)**: ì˜ˆì‹œ) ëª¨ë¸ë“¤ì´ ëŒ€ë¶€ë¶„ **80% ì´ìƒì˜ ì •í™•ë„**ë¥¼ ë³´ì˜€ìœ¼ë©°, **ê³ ê° ì´íƒˆ ì˜ˆì¸¡ ë¬¸ì œ**ì—ì„œ ìƒë‹¹íˆ **ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì˜ˆì¸¡ ì„±ëŠ¥**ì„ ë‚˜íƒ€ëƒˆìŠµë‹ˆë‹¤.</br>

- **ì •ë°€ë„(Precision)**ì™€ **ì¬í˜„ìœ¨(Recall)**: [ê²°ê³¼ ì„¤ëª…]

- **F1 Score**: [ê²°ê³¼ ì„¤ëª…]

- **ROC-AUC**: [ê²°ê³¼ ì„¤ëª…]

</br>


### 6. íŒ€ì› íšŒê³ 
ê¹€ì„±ê·¼
>
>
ëŒ€ì„±ì›
> 
>
ìœ¤ì •ì—°
> 
> 
ìœ ìˆ˜í˜„
>
>
ì •ìŠ¹ì—°
>
>
</br>
